<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Index</title>
<style>
    .ctn {
        position: relative;
        width: 1000px;
        min-height: 200px;
        margin: 20px auto;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    ul {
        list-style: none;
        width: 100px;
        text-align: center;
    }
    li {
        height: 20px;
        margin-top: 30px;
        line-height: 20px;
        border: 1px solid #ccc;
    }

</style>
</head>
<body>
   <ul>
       <li draggable="true">01</li>
       <li draggable="true">02</li>
       <li draggable="true">03</li>
       <li draggable="true">04</li>
       <li draggable="true">05</li>
   </ul>

<script>

var startDrag = false,          // drag start
    startEnter = false,         // enter start
    dragPara   = false,         // parameters
    startEnd    = false,        // 开始拖动结束
    msgArray   = [];            // 位置信息

var tar = document.getElementsByTagName("ul")[0];
tar.addEventListener("mousedown", function(e){
    dragPara = true;
});

tar.addEventListener("mouseup", function(e){
    dragPara = false;
    startEnd = false;
});

var gutter = 10;
tar.addEventListener("mousemove", function(e){
    if(startEnd === false){
        startEnd = true;

        if(dragPara){
            // drag start
            startDrag = true;

            // 计算tar元素及其需要碰撞的子元素的位置
            // tar 的 offsetTop, offsetLeft; width, height
            // 左边： offsetLeft; 右边: offsetLeft + width; 上边: offsetTop; 下边: offsetTop + height
            // childs
            var item = tar.firstElementChild;
            msgArray.length = 0;
            var totalHeight = 0;
            while(item){
                totalHeight += item.offsetHeight;
                msgArray.push(totalHeight);

                totalHeight += gutter;
            }
        }
    }

    // 何时碰撞
    if(startDrag){
        var x = e.offsetX, y = e.offsetY;

        if(x < parLeft || x > parRight || y < parTop || y > parBottom){
            // 在边界之外
            return false;
        }


    }
});

function lookIndex(arr, val){
    // arr : 升序排列, 找到 item<val && item.next >= val
    var len = arr.length;

    var pre = 0, next = len, mid = parseInt(len/2) + 1;
    var cur = arr[mid];
    if(val > cur){
        pre = mid;
        mid = parseInt((pre+next)/2) + 1;
        cur = arr[cur];
        // look agagin
    }else if(val < cur){
        next = mid;
        mid = parseInt((pre+next)/2) + 1;
        cur = arr[cur];
        // look agagin
    }else{
        // 返回 mid 的索引
        return mid;
    }
}


var dragEle = null;


</script>
</body>
</html>
